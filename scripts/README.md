# Скрипты импорта викторин

## Импорт из Excel

Универсальный скрипт для импорта викторин из Excel файлов в JSON.

### Использование

```bash
npm run import:quizzes
```

### Структура Excel файлов

#### 1. party_quizz.xlsx → app/data/questions.json

Поля вопросов:
- `Slug` - идентификатор викторины (например, "party-quizz")
- `questionID` - уникальный номер вопроса
- `question` - текст вопроса
- `mechanicsType` - тип механики (simple4, blitz, etc.)
- `answerCost` - количество баллов за правильный ответ
- `answer1` - правильный ответ
- `wrong1`, `wrong2`, `wrong3` - неправильные варианты
- `comment` - комментарий к вопросу
- `category` - категория вопроса
- `pic1`, `pic2` - ссылки на картинки (опционально)

#### 2. quizz_mechanics.xlsx → app/data/mechanics.json

Поля механик:
- `mechanicsType` - идентификатор механики
- `script` - описание логики механики
- `promptText` - текст подсказки для игроков

#### 3. quizzes_slugs.xlsx → app/data/quizzes.ts

Метаданные викторин:
- `id` - уникальный идентификатор
- `slug` - URL-идентификатор (должен совпадать с Slug в вопросах)
- `title` - название викторины
- `description` - описание викторины
- `type` - тип/категория викторины
- `price` - цена (0 = бесплатно)
- `questions` - количество вопросов (опционально)
- `duration` - длительность (опционально)

### Примечания

- Все Excel файлы должны находиться в `C:\Users\azper\YandexDisk\yoplix\quizzes\`
- Импорт автоматически нормализует поля и типы данных
- Пустые значения игнорируются
- После импорта файлы сохраняются в `app/data/`

### Результаты последнего импорта

```
✅ Вопросов: 43
✅ Механик: 4
✅ Викторин: 0 (нужно проверить quizzes_slugs.xlsx)
```

### Система механик

После импорта:
- Вопросы сохраняются в `app/data/questions.json` с полем `mechanicsType`
- Механики сохраняются в `app/data/mechanics.json` с полями `mechanicsType`, `script`, `promptText`
- При запросе вопроса через API, он автоматически обогащается `promptText` из соответствующей механики
- В `promptText` подстановка `answerCost` заменяется на фактическое значение из вопроса

### Реализованные механики

- **simple4**: 4 варианта ответа в случайном порядке, начисление баллов, бонус первому правильному ответу

